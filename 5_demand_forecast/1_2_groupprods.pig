data = LOAD './allrenamedprods.csv' USING PigStorage(',') AS (Product:chararray,Apr12:float,May12:float,Jun12:float,Jul12:float,Aug12:float,Sep12:float,Oct12:float,Nov12:float,Dec12:float,Jan13:float,Feb13:float,Mar13:float,Apr13:float,May13:float,Jun13:float,Jul13:float,Aug13:float,Sep13:float,Oct13:float,Nov13:float,Dec13:float,Jan14:float,Feb14:float,Mar14:float,Apr14:float,May14:float,Jun14:float,Jul14:float,Aug14:float,Sep14:float,Oct14:float,Nov14:float,Dec14:float,Jan15:float,Feb15:float,Mar15:float,Apr15:float,May15:float,Jun15:float,Jul15:float,ItemCount:float,Revenue:float);

grouped = GROUP data BY Product;

grp_fields = FOREACH grouped GENERATE group, SUM(data.Apr12) AS Apr12,SUM(data.May12) AS May12,SUM(data.Jun12) AS Jun12, SUM(data.Jul12) AS Jul12,SUM(data.Aug12) AS Aug12,SUM(data.Sep12) AS Sep12,SUM(data.Oct12) AS Oct12,SUM(data.Nov12) AS Nov12,SUM(data.Dec12) AS Dec12,SUM(data.Jan13) AS Jan13,SUM(data.Feb13) AS Feb13,SUM(data.Mar13) AS Mar13,SUM(data.Apr13) AS Apr13,SUM(data.May13) AS May13,SUM(data.Jun13) AS Jun13,SUM(data.Jul13) AS Jul13,SUM(data.Aug13) AS Aug13,SUM(data.Sep13) AS Sep13,SUM(data.Oct13) AS Oct13,SUM(data.Nov13) AS Nov13,SUM(data.Dec13) AS Dec13,SUM(data.Jan14) AS Jan14,SUM(data.Feb14) AS Feb14,SUM(data.Mar14) AS Mar14,SUM(data.Apr14) AS Apr14,SUM(data.May14) AS May14,SUM(data.Jun14) AS Jun14,SUM(data.Jul14) AS Jul14,SUM(data.Aug14) AS Aug14,SUM(data.Sep14) AS Sep14,SUM(data.Oct14) AS Oct14,SUM(data.Nov14) AS Nov14,SUM(data.Dec14) AS Dec14,SUM(data.Jan15) AS Jan15,SUM(data.Feb15) AS Feb15,SUM(data.Mar15) AS Mar15,SUM(data.Apr15) AS Apr15,SUM(data.May15) AS May15,SUM(data.Jun15) AS Jun15,SUM(data.Jul15) AS Jul15,SUM(data.ItemCount) AS ItemCount,SUM(data.Revenue) AS Revenue;

STORE grp_fields INTO './reqdprods' USING PigStorage(',');
